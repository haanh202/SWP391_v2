<!-- Product Detail Start -->
@model OnlineMarketPlace.Models.Product
@{
    var categoriesL = ViewData["CategoriesList"] as OnlineMarketPlace.Models.CategoriesList;
}
 @*@Html.Partial("_SidebarPartial", categoriesL); *@

<div class="product-detail">

    <div class="container">
        <div class="row">
            <div class="col-lg-9">
                <div class="row align-items-center product-detail-top">
                    <div class="col-md-5">
                        <div class="product-slider-single">
                            <img src="~/images/@Model.Image" alt="Product Image">

                        </div>
                    </div>
                    <div class="col-md-7">
                        <div class="product-content">
                            <div class="title"><h2>@Model.Name</h2></div>
                            <div class="price">@Model.Price</div>
                            <div class="details">
                                <p>
                                    <a href="#reviews" style="text-decoration: none; color: inherit;">
                                        @{
                                            var rating = ViewData["AverageRating"] != null ? (double)ViewData["AverageRating"] : 0.0;
                                            var roundedRating = Math.Round(rating, 1);
                                        }                                       
                                        <span>(@roundedRating)</span>
                                        <i class="fa fa-star"></i>
                                        
                                    </a>
                                    | <a href="#reviews" style="text-decoration: none; color: inherit;">
                                        @Model.RatingAndReviews.Count Review
                                    </a>
                                    | @Model.QuantitySold Selled
                                    | <span style="color: #007bff; cursor: pointer;">Report</span>

                                </p>
                                <p>Availability: @Model.Inventory</p>
                            </div>

                            <div class="quantity">
                                <h4>Quantity:</h4>
                                <div class="qty">
                                    <button class="btn-minus"><i class="fa fa-minus"></i></button>
                                    <input type="text" value="1">
                                    <button class="btn-plus"><i class="fa fa-plus"></i></button>
                                </div>

                            </div>
                            <div class="action">
                                <a href="#"><i class="fa fa-cart-plus"></i></a>
                                <a href="#"><i class="fa fa-heart"></i></a>

                                @Html.Partial("ProductReviewModal")
                                <button type="button" class="btn btn-fefault review" data-product-id="@Model.Id" data-product-name="@Model.Name">
                                    Rate
                                </button>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="row product-detail-bottom">
                    <div class="col-lg-12">
                        <ul class="nav nav-pills nav-justified">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="pill" href="#description">Description</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="pill" href="#specification">Shop Information</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="pill" href="#reviews">Reviews (@Model.RatingAndReviews.Count)</a>
                            </li>
                        </ul>

                        <div class="tab-content">
                            <div id="description" class="container tab-pane active">
                                <br>
                                <h4>Product description</h4>
                                <p>
                                    @Model.Description
                                </p>
                            </div>
                            <div id="specification" class="container tab-pane fade">
                                <br>
                                <h4>Shop Information</h4>
                                <ul>
                                    <li>Lorem ipsum dolor sit amet</li>
                                    <li>Lorem ipsum dolor sit amet</li>
                                    <li>Lorem ipsum dolor sit amet</li>
                                    <li>Lorem ipsum dolor sit amet</li>
                                    <li>Lorem ipsum dolor sit amet</li>
                                </ul>
                            </div>
                            <div id="reviews" class="container tab-pane fade">
                                <br>
                                <div class="reviews-submitted">
                                    <div class="reviewer">Phasellus Gravida - <span>01 Jan 2020</span></div>
                                    <div class="ratting">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    @{
                                        var reviews = ViewData["rv"] as List<OnlineMarketPlace.Models.RatingAndReview>;
                                    }
                                    <p>
                                        @if (reviews != null && reviews.Any())
                                        {
                                            @* <p>@($"Found {reviews.Count} reviews.")</p> <!-- Hiển thị số lượng phần tử --> *@
                                            <ul>
                                                @foreach (RatingAndReview review in reviews)
                                                {
                                                    <li>

                                                        @* <strong>Rating:</strong> @review.Rating <br /> *@
                                                        @* <strong>Review:</strong>  *@
                                                        @review.Review
                                                    </li>
                                                }
                                            </ul>
                                        }
                                        else
                                        {
                                        <p>No reviews available.</p>
                                        }
                                    </p>
                                </div>
                                <div class="reviews-submit">
                                    <h4>Give your Review:</h4>
                                    <div class="ratting">
                                        <i class="fa fa-star-o"></i>
                                        <i class="fa fa-star-o"></i>
                                        <i class="fa fa-star-o"></i>
                                        <i class="fa fa-star-o"></i>
                                        <i class="fa fa-star-o"></i>
                                    </div>
                                    <div class="row form">
                                        <div class="col-sm-6">
                                            <input type="text" placeholder="Name">
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="email" placeholder="Email">
                                        </div>
                                        <div class="col-sm-12">
                                            <textarea placeholder="Review"></textarea>
                                        </div>
                                        <div class="col-sm-12">
                                            <button>Submit</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <div class="section-header">
                        <h3>Related Products</h3>
                    </div>
                </div>



                @{
                    var relatedProducts = ViewData["RelatedProducts"] as List<OnlineMarketPlace.Models.Product>;
                }

                <div class="row align-items-center product-slider product-slider-3">
                    @if (relatedProducts != null && relatedProducts.Any())
                    {
                        foreach (var product in relatedProducts)
                        {
                            <div class="col-lg-3">
                                <div class="product-item">
                                    <div class="product-image">
                                        <a href="@Url.Action("Details", "Product", new { id = product.Id })">
                                            <img src="@product.Image" alt="@product.Name">
                                        </a>
                                        <div class="product-action">
                                            <a href="#"><i class="fa fa-cart-plus"></i></a>
                                            <a href="#"><i class="fa fa-heart"></i></a>
                                            <a href="#"><i class="fa fa-search"></i></a>
                                        </div>
                                    </div>
                                    <div class="product-content">
                                        <div class="title">
                                            <a href="@Url.Action("Details", "Product", new { id = product.Id })">@product.Name</a>
                                        </div>

                                        <div class="price">
                                            $@product.Price
                                            @if (product.Price > product.Price)
                                            {
                                                <span>$@product.Price</span>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="col-12 text-center">
                            <p>Không có sản phẩm liên quan</p>
                        </div>
                    }
                </div>

            </div>

            
            <!-- siderbar -->
            <div class="col-sm-3">
                 @Html.Partial("_SidebarPartial", categoriesL)
            </div>
        </div>
    </div>
</div>
<!-- Product Detail End -->